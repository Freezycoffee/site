<!DOCTYPE HTML>
<!--
	Astral by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Khofi Alfian</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="icon" href="images\icons8-puzzle-48.png">
		<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script>
			function toggleArticle (element){
				var article = element.nextElementSibling;
				article.style.display = (article.style.display=='none')?'block':'none';
			}
		</script>

	</head>
	<body class="is-preload">

		<!-- Wrapper-->
			<div id="wrapper">

				<!-- Nav -->
					<nav id="nav">
						<a href="#" class="icon solid fa-home"><span>Home</span></a>
						<a href="#work" class="icon solid fa-folder"><span>Work</span></a>
						<a href="#contact" class="icon solid fa-envelope"><span>Contact</span></a>
						<a href="https://twitter.com/AlfianKhofi" class="icon brands fa-twitter" target="_blank"><span>Twitter</span></a>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Me -->
							<article id="home" class="panel intro">
								<header>
									<h1>Khofi Alfian</h1>
									<p>Data Analyst, Machine Learning and Liverpool FC Fans</p>
								</header>
								<a href="https://linkedin.com/in/khofi-alfian-b27414182/" class="jumplink pic" target="_blank">
									<img src="images/me.jpg" alt="" />
								</a>
							</article>
						<!-- Work -->
							<article id="work" class="panel">
								<h2>Work</h2>
								<br>
								<ol>
									<li>
										<header>
										<h1><strong>Build an Expected Goals(xG) model for Indonesian Liga 1</strong></h1>
									</header>
									<p>
										Expected Goals (xG) adalah sebuah metrik dalam sepak bola yang mengukur peluang sebuah tembakan menjadi gol. Nilai xG sendiri berkisar dari 0 hingga 1. Satu artinya pasti menjadi gol dan nol artinya tidak mungkin menjadi gol. 
									</p>
									<p>Untuk bisa mengetahui nilai peluang dengan xG saya membuat model machine learning untuk klasifikasi dengan algoritma Gradient Boosting menggunakan data yang saya kumpulkan berkaitan dengan tembakan (shots) di Liga 1. Berikut adalah langkah-langkahnya:</p>
									<ul class="step">
										<li>
											<h6 onclick="toggleArticle(this)" class="langkah">Pengumpulan Data</h6>
											<article class="steps">
												<p>
													Pengumpulan data dapat dilakukan dengan beberapa cara untuk cara yang saya gunakan yang pertama adalah manually input data dan scrape data dari website penyedia statistik pertandingan seperti sofascore.com. Untuk melakukan scrapping yang saya gunakan sendiri caranya adalah dengan me-recreate <i>API-calls</i> dari website tersebut. Berikut adalah <i>step-by-step</i>-nya :
													<ol>
														<li>Pergi ke website <a href="http://www.sofascore.com/" target="_blank">sofascore.com</a>, pilih match yang ingin di-scrape datanya.
														</li>
														<li>Lalu klik kanan dan klik inspect atau periksa <br>
															<img src="images\step1.png" alt="">
														</li>
														<li>
															Lalu masuk ke tab Network pilih <b>fetch/XHR</b>, kemudian cari item yang bernama <b>shotmap</b> klik kanan dan copy lalu copy as cURL (bash). <br>
															<img src="images\step2.png" alt="">
														</li>
														<li>
															Lalu pergi ke <a href="https://curlconverter.com" target="_blank">curl converter</a> dan paste shotmap info yang telah di-copy. Kemudian copy hasil dari converter tersebut. <br>
														<img src="images\step3.png" alt="">
														</li>
														<li>Jalankan script yang telah di-copy dari web converter tersebut di IDE python lalu save. Berikut adalah contoh kode-nya.
														<pre><code class="language-python">
import requests
import pandas as pd
headers = {
    'authority': 'api.sofascore.com',
    'accept': '*/*',
    'accept-language': 'id,en;q=0.9,en-GB;q=0.8,en-US;q=0.7',
    'cache-control': 'max-age=0',
    'if-none-match': 'W/"4074ef5a9a"',
    'origin': 'https://www.sofascore.com',
    'referer': 'https://www.sofascore.com/',
    'sec-ch-ua': '"Microsoft Edge";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'empty',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-site',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 Edg/119.0.0.0',
    'If-Modified-Since':'Sat, 2 Dec 2023 00:00:00'
    }

response = requests.get('https://api.sofascore.com/api/v1/event/11865262/shotmap', headers=headers)

# cek status code
response.status_code

# menyimpan hasil scrape
shot = response.json()
df = pd.DataFrame(shot['shotmap'])
df.to_csv('shot-data.csv')
														</code>
														</pre>
														</li>
													</ol>
												</p>
											</article>
										</li>
										<li>
											<h6 onclick="toggleArticle(this)" class="langkah">Persiapan Data</h6>
											<article class="steps">
												<p>
													Langkah selanjutnya adalah mempersiapkan data yang akan digunakan untuk melatih model. Data tersebut harus mencakup variabel-variabel yang relevan dengan target yang ingin diprediksi. Dalam kasus ini, variabel-variabel yang umumnya digunakan adalah:
													<ul>
														<li><b>Posisi Pemain yang melakukan tendangan</b><br>Posisi pemain akan berpengaruh pada kualitas sebuah tendangan. Umumnya gol akan banyak dicetak oleh penyerang daripada pemain yang berposisi sebagai pemain bertahan. Hal tersebut berlaku juga untuk <b>Teknik tendangan, Jenis umpan, Situasi permainan, dan Bagian tubuh yang digunakan untuk menendang </b></li>
														<li><b>Jarak tendangan</b><br>Jarak tendangan bisa diukur dengan pertama mengetahui koordinat x dan y pemain, kemudian dihitung dengan rumus pythagoras relatif terhadap gawang.</li>
														<li><b>Sudut tendangan</b><br> Untuk menghitung sudut bisa dihitung dengan memasukan jarak yang sudah dihitung sebelumnya ke dalam rumus inverse cosine. berikut adalah contohnya.
														<span class="formula">
															<b>Sudut A = acos((AB^2 + AC^2 - BC^2) / 2*(AB*AC))</b>
														</span>
														<b> atau </b>
														<span class="formula">
															<b>Sudut A = cos^-1((AB^2 + AC^2 - BC^2) / 2*(AB*AC))</b>
														</span>
														<img src="images\20231026_205211_0000.png" alt="" id="formula">
														</li>
														<li><b>Teknik tendangan</b></li>
														<li><b>Jenis umpan</b></li>
														<li><b>Situasi Permainan</b></li>
														<li><b>Bagian tubuh yang digunakan untuk menendang</b></li>
													</ul>
													<p>Kemudian setelah variabel-variabel yang dibutuhkan tersedia selanjutnya adalah pembersihan data yaitu mengecek adakah outlier dalam data. Hal tersebut bisa dilakukan dengan mem-visualisasikan data yang telah dikumpulkan. Untuk visualisasi saya menggunakan library <b>mplsoccer</b>. Berikut adalah contoh visualisasi dimana titik biru muda menunjukan gol dan titik merah menunjukan tidak gol.
													</p> <br>
													<pre><code class="language-python line-numbers" data-prismjs-copy="Copy">
!pip install mplsoccer
from mplsoccer import VerticalPitch
pitch = VerticalPitch(pad_bottom=0.5,
                      half=True,
                      goal_type='box',
                      goal_alpha=0.8,
                      pitch_color='white',
                      linewidth=3)
# draw pitch
fig, ax = pitch.draw(figsize=(12, 10))

# non-goal shots
sc1 = pitch.scatter(shot.x, shot.y,
					s=100,
					c='#f43b56',
					marker='o',
					alpha=0.8,
					ax=ax,)
# goal shots					  
sc2 = pitch.scatter(goal.x, goal.y,
					s=100,
					c='#8ff1ff',
					marker='o',
					alpha=0.8,
					ax=ax)
					  
txt = ax.text(x=40, y=75, s='Liga 1 Shots Map',
				alpha=.6,
				size=30,color='grey',
				va='center', ha='center')
name = ax.text(x=1,y=61,s='Khofi Alfian\n@AlfianKhofi',
				size=11,color='grey',
				va='bottom',ha='left')
													</code></pre>
													<div id="img">
														<img src="images\shot.png" alt="" id="shot">
													</div><br>
													<p>dari visualisasi tersebut dapat dilihat ada beberapa outlier seperti: Goal yang dicetak dari corner-kick tentu hal tersebut adalah hal yang jarang terjadi, lalu goal yang dicetak dari jarak yang cukup jauh hampir dari garis tengah itu juga termasuk outlier. Sebelum masuk ke pembuatan model sebaiknya outlier tersebut dibersihkan terlebih dahulu.</p>
												</p>
											</article>
										</li>
										<li>
											<h6 onclick="toggleArticle(this)" class="langkah">Pembuatan Model</h6>
											<article class="steps">
											<p>Untuk pembuatan model, langkah pertama adalah menginstall library yang diperlukan di antaranya : XGBoost, SkLearn, Pandas, Numpy dan Library untuk visualisasi</p>
											<p><pre><code class="language-python line-numbers">
!pip install xgboost
!pip install scikit-optimize
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from mplsoccer import VerticalPitch,Pitch
from sklearn.model_selection import train_test_split
from sklearn.metrics import classification_report,
							roc_auc_score,
							confusion_matrix
from xgboost import XGBClassifier
from skopt import BayesSearchCV
											</code></pre></p>
											<p>Langkah selanjutnya adalah membuat dataframe dengan pandas, kemudian membagi data tersebut menjadi data training dan data test menggunakan <code>train_test_split()</code> dari sklearn.<br>
											Untuk contoh dataset yang bisa digunakan untuk membuat model xG bisa dilihat <a href="https://drive.google.com/drive/folders/1AG1kYRk6Gqb1PI27TNWkB-xQ7bTamDaU?usp=drive_link" target="_blank">di sini</a>. Data tersebut adalah dataset seluruh shot dari kompetisi FIFA U-17 World Cup. Karena XGBoost hanya bisa menerima kolom yang memiliki nilai berupa angka dan masih ada kolom yang memiliki value berupa string kita bisa menggunakan get_dummies() function dari pandas untuk mengubah value tersebut.
											<pre><code class="language-python line-numbers">
df = pd.read_excel('fifa_wc_u_17_xg.xlsx',sheet_name='fifa_wc_u_17_xg')
# pilih kolom yang akan dipelajari oleh model
feature = ['player_pos', 'distance_to_l','distance_to_r', 'angle',
       'shot_technique', 'player_in_the_way', 'pass_type', 'situation',
       'inside_pen_box', 'inside_6_box', 'header', 'weaker_foot',
       'strong_foot','other_part','big_chances','on_target']
# pembagian data
X = pd.get_dummies(df[feature])
y = df.is_goal
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2)											
											</code></pre><br>
											Kemudian karena menggunakan optimization dari scikit, perlu membuat search space atau singkatnya adalah bagaimana model nantinya akan belajar. Sebelumnya karena adanya imbalance antara jumlah gol dan tidak gol maka perlu juga untuk dibuat ratio.
											<pre><code class="language-python line-numbers">
ratio = y_train.value_counts()[0]/y_train.value_counts()[1]
space ={'learning_rate':[0.001,0.01,0.1,0.25,0.5,1.0],\
        'max_depth':[2,3,4,5,6,7],\
        'n_estimator':[150,200,250,300,350,400]\
		'subsample':[0.5,0.6,0.7,0.8,0.9,1.0],\
        'colsample_bytree':[0.5,0.6,0.7,0.8,0.9,1.0],\
        'colsample_bylevel':[0.5,0.6,0.7,0.8,0.9,1.0],\
        'colsample_bynode':[0.5,0.6,0.7,0.8,0.9,1.0],\
        'reg_alpha':[0.5,0.6,0.7,0.8,0.9,1.0],\
        'reg_lambda':[0.0,0.1,0.2,0.3,0.4,0.5],\
        'gamma':[0.0,0.1,0.2,0.3,0.4,0.5]}
# pembuatan model
model = XGBClassifier(scale_pos_weight=ratio)
xG = BayesSearchCV(model,space,scoring='roc_auc',cv=3,n_iter=7)
# melatih model
xG.fit(X_train,y_train)											
											</code></pre><br>
											Angka-angka yang ada di space tersebut bisa disesuaikan dengan model yang akan dibuat dan banyaknya data yang digunakan begitu juga dengan cross validation (cv) dan number of iteration (n_iter) semakin tinggi angkanya maka semakin baik model dalam belajar namun akan memakan waktu yang cukup lama dan juga resiko overfitting. 
											</p>
											</article>
										</li>
										<li>
											<h6 onclick="toggleArticle(this)" class="langkah">Evaluasi Model</h6>
											<article class="steps">
												<p>Langkah selanjutnya adalah evaluasi model. Ada beberapa metrik yang dapat digunakan untuk mengevaluasi model namun yang umum digunakan pada kasus klasifikasi adalah roc_auc_score. Metrik yang digunakan untuk mengevaluasi kinerja model klasifikasi biner. Ini mengukur kemampuan model untuk membedakan antara dua kelas di semua batas klasifikasi yang mungkin. Kurva ROC adalah plot yang menggambarkan tingkat positif sebenarnya (sensitivitas) terhadap tingkat positif palsu (spesifisitas 1) untuk ambang klasifikasi yang berbeda. Tingkat positif sebenarnya (TPR) adalah proporsi kasus positif aktual yang diidentifikasi dengan benar oleh model, sedangkan tingkat positif palsu (RPF) adalah proporsi kasus negatif aktual yang salah diidentifikasi sebagai positif. AUC-ROC adalah area di bawah kurva ROC ini. Ini berkisar dari 0 hingga 1, di mana nilai yang lebih tinggi menunjukkan kinerja model yang lebih baik. Sebuah AUC-ROC dari 1 mewakili pengklasifikasi sempurna yang dapat membedakan antara dua kelas tanpa kesalahan, sedangkan AUC-ROC dari 0.5 menunjukkan bahwa model tidak lebih baik dari peluang acak. Dalam praktiknya, nilai AUC-ROC yang mendekati 1 lebih disukai, karena menunjukkan kemampuan model untuk mengklasifikasikan kasus positif dan negatif secara akurat.
												<pre><code class="language-python line-numbers">
y_predict = xG.predict(X_test)
y_predict_prob = xG.predict_proba(X_test)[:,1]
auc = roc_auc_score(y_test,y_predict_prob)

print(f'auc:{auc}')
print(classification_report(y_test,y_predict))

# confusion matrix plot
cm = confusion_matrix(y_test,y_predict)
sns.heatmap(cm,annot=True)
												</code></pre>
												</p>
											</article>
											</li>
											<li>
												<h6 onclick="toggleArticle(this)" class="langkah">Penggunaan Model</h6>
												<article class="steps">
													<p>Untuk penggunaan model saya menggunakan untuk melihat performa xG beberapa pertandingan Liga 1, juga seluruh pertandingan dari FIFA U-17 World Cup. Berikut adalah contoh grafik dari pertandingan final U-17 World Cup Antara France melawan Germany.</p>
													<div id="img">
														<img src="images\final_ger_fra_match.png" alt="">
													</div>
													<p>Dari grafik tersebut dapat dilihat Germany mengakumulasi xG sebanyak 2.7 yang artinya paling tidak mereka mencetak 2 gol begitu juga dengan France yang mengakumulasikan xG sebesar 2.49, yang mana adalah benar bahwa di pertandingan tersebut kedua tim mencetak 2 gol. Dan harus menentukan juara dengan adu penalti dimana Germany keluar sebagai kampiun.</p>
													<p>Di bawah ini adalah shotmap dari seluruh shot tim Germany di FIFA U-17 World Cup 2023 Indonesia. Dapat dilihat dari semua gol yang dicetak tim Germany semuanya dari dalam kotak penalti kecuali satu. Semakin besar titik dalam grafik tersebut menandakan semakin besar peluang xG atau peluang sebuah shot dapat menjadi gol.</p>
													<div id="img">
														<img src="images\germany.png" alt="">
													</div>
												</article>
											</li>
											</ul>
									<br><br>
									<li class="adidas">
										<h2>Adidas Sales Analysis</h2><br>
										<p>This Project is created using data from <a href="https://www.kaggle.com/datasets/heemalichaudhari/adidas-sales-dataset/" target="_blank">Kaggle datasets</a> which i created dashboard from using <a href="https://lookerstudio.google.com/embed/reporting/72a52e0a-b28d-42fa-beca-adddf4dfeac8/page/1M" target="_blank">Google Looker Studio.</a> The data itself contains 9652 rows and 14 Columns in total</p>
										<div id="analysis">
											<iframe width="600" height="900" src="https://lookerstudio.google.com/embed/reporting/72a52e0a-b28d-42fa-beca-adddf4dfeac8/page/1M" frameborder="0" style="border:0" allowfullscreen></iframe>									
										</div>
									</li>
								</ol>
								
							</article>

						<!-- Contact -->
							<article id="contact" class="panel">
								<header>
									<h2>Contact Me</h2>
								</header>
								<form action="https://formsubmit.co/6c80894279a1e70ec30769e3151aad49" method="POST">
									<input type="text" name="_honey" style="display: none;">
									<input type="hidden" name="_next" value="https://freezycoffee.github.io/site/#contact">
									<input type="hidden" name="_captcha" value="false">
									<div>
										<div class="row">
											<div class="col-6 col-12-medium">
												<input type="text" name="name" placeholder="Name"/>
											</div>
											<div class="col-6 col-12-medium">
												<input type="text" name="email" placeholder="Email"/>
											</div>
											<div class="col-12">
												<input type="text" name="subject" placeholder="Subject"/>
											</div>
											<div class="col-12">
												<textarea name="message" placeholder="Message" rows="6"></textarea>
											</div>
											<div class="col-12">
												<input type="submit" value="Send Message" />
											</div>
										</div>
									</div>
								</form>
							</article>

					</div>

				<!-- Footer -->
					<div id="footer">
							<b>&copy; Khofi Alfian 2023</b>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js" integrity="sha256-NSwb7O0HrDJcC+2SASgGuCP8+tdpIhqnzLTZkGRJRCk=" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/remove-initial-line-feed/prism-remove-initial-line-feed.js" integrity="sha256-rLEmlPVcY3+5JIOTtFDQAarl98NYg1yMIup9c6+v9ug=" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" integrity="sha256-qf3MqHLzDh4qqAnc9QVmqjEWBA4CfzP1YwRFbfNfpnE=" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha256-9cmf7tcLdXpKsPi/2AWE93PbZpTp4M4tqzFk+lWomjU=" crossorigin="anonymous"></script>

	</body>
</html>